<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-gb">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title>Facebook Connect Helper for iOS</title>
	<meta name="author" content="Roger Chapman" />
	<link href="http://feeds.feedburner.com/rogchap" rel="alternate" title="Roger Chapman" type="application/atom+xml" />
	<link rel="stylesheet" href="/css/syntax.css" type="text/css" media="all" />
	<link rel="stylesheet" href="/css/screen.css" type="text/css" media="all" />
	<link rel="stylesheet" href="/css/tablet.css" type="text/css" media="screen and (min-width:651px) and (max-width: 1024px), screen and (min-device-width: 768px) and (max-device-width: 1024px)" />
	<link rel="stylesheet" href="/css/mobile.css" type="text/css" media="handheld, screen and (max-width: 650px), screen and (max-device-width: 480px)" />
</head>
<body>
	<div class="site">
		<div class="title"><a href="/">Roger Chapman<br/>rogchap</a></div>
		<div id="post">
	<h1>Facebook Connect Helper for iOS</h1>
	<p class="meta">06 Jun 2011</p>
	<p>Many iPhone/iPad apps use Facebook Connect, and Facebook have made this really easy with their <a href="https://github.com/facebook/facebook-ios-sdk">Facebook iOS SDK</a>.</p>

<p>One thing that you will always most likely want to do is make sure that the user only has to log in once, and every time time they want to use your app that they are already authenticated with Facebook. This means two things: first you need to make sure you authenticate the user with the <code>offline_access</code> flag and secondly, save the access tokens for the next time your app is used.</p>

<p>This led me to create a very simple helper class that I use in conjunction with the Facebook SDK to make my life a little easier:</p>

<pre><code>// FacebookHelper.h

#import "FBConnect.h"
@interface FacebookHelper : NSObject {

}

+(Facebook*)fb;
+(void) resume;
+(void) save;
+(void) revoke;

@end

//FacebookHelper.m

static NSString* kFBAccessToken = @"FBAccessToken";
static NSString* kFBExpirationDate = @"FBExpirationDate";

@implementation FacebookHelper

+(Facebook*)fb {
	static Facebook *fb = nil;

	if (fb == nil) {
		fb = [[Facebook alloc] initWithAppId:FB_APP_ID];
	}

	return fb;
}

+(void) resume {
  NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
  Facebook *facebook = [FacebookHelper fb];
  facebook.accessToken = [defaults stringForKey:kFBAccessToken];
  facebook.expirationDate = (NSDate*)[defaults objectForKey:kFBExpirationDate];
}

+(void) save {
  NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
  Facebook *facebook = [FacebookHelper fb];

  [defaults setObject:facebook.accessToken forKey:kFBAccessToken];
  [defaults setObject:facebook.expirationDate forKey:kFBExpirationDate];
  [defaults synchronize];
}

+(void) revoke {
  NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
  [defaults removeObjectForKey:kFBAccessToken];
  [defaults removeObjectForKey:kFBExpirationDate];
  [defaults synchronize];
}

@end
</code></pre>

<p>As you can see I have a static object for the Facebook SDK, and three simple static method to help me deal with login and logout. Now in my <code>applicationDidFinishLaunching</code> method on my <code>AppDelegate</code> I simply call:
	[FacebookHelper resume];
And when <code>fbDidLogin</code> and <code>fbDidLogin</code> are called:
	[FacebookHelper save];
and
	[FacebookHelper revoke];</p>

<p>Simple!</p>


    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
    <g:plusone></g:plusone>

</div>



<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>23 Aug 2013</span> <span class="seperator">~</span> <a href="/2013/08/23/custom-uiview-animations-with-vector-graphics/">Custom UIView Animations with Vector Graphics</a></li>
    
      <li><span>13 Aug 2013</span> <span class="seperator">~</span> <a href="/2013/08/13/simple-ios-dropdown-control-using-uitextfield/">Simple iOS Dropdown Control using UITextField</a></li>
    
      <li><span>07 Feb 2013</span> <span class="seperator">~</span> <a href="/2013/02/07/image-resize-middleware-for-expressjs/">Image Resize Middleware for Express.js</a></li>
    
  </ul>
</div>




<div class="ads">
    <script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- Leaderboard -->
    <ins class="adsbygoogle"
         style="display:inline-block;width:728px;height:90px"
         data-ad-client="ca-pub-3092587044574000"
         data-ad-slot="3996431372"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

<div class="comments">
	<h3>Comments</h3>
	<noscript>Please enable JavaScript to view the comments</noscript>
	<div id="disqus_thread"></div>
</div>
<script type="text/javascript">
    var disqus_shortname = 'rogchap'; 
    var disqus_identifier = '/2011/06/06/facebook-connect-helper-for-ios';
    var disqus_url = 'http://rogchap.com/2011/06/06/facebook-connect-helper-for-ios/';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

		<div class="footer">
			<div class="contact">
				<p>
					Roger Chapman<br/>
					Application Development Evangelist<br/>
					&#114;&#111;&#103;&#99;&#104;&#97;&#112;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;
				</p>
			</div>
			<div class="contact">
				<p>
					<a href="http://github.com/rogchap/">github.com/rogchap</a><br />
					<a href="http://twitter.com/rogchap/">twitter.com/rogchap</a><br />
					<a href="http://linkedin.com/in/rogchap/">linkedin.com/in/rogchap</a>
				</p>
			</div>
		 	<div class="rss">
				<a href="http://feeds.feedburner.com/rogchap">RSS Feed</a>
			</div>
		</div>
	</div>

    <script type="text/javascript">
        var _gaq = _gaq || [];
        var pluginUrl = '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
        _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
        _gaq.push(['_setAccount', 'UA-4155555-8']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>
</body>
<html>